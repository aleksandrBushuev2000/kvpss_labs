(window.webpackJsonp=window.webpackJsonp||[]).push([[1],[,,,,,function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e,s){"use strict";s.r(e);class i{addClass(t){return!!this.isRendered&&(this.renderedNode.classList.add(t),!0)}removeClass(t){return!!this.isRendered&&(this.renderedNode.classList.remove(t),!0)}getRenderState(){return this.isRendered}render(t){const e=this.makeNode();t.append(e),this.renderedNode=e,this.isRendered=!0}destroy(){this.isRendered=!1,this.removeNode()}}class n extends i{constructor(){super(),this.subscribers=[]}pushSubscriber(t){this.subscribers.push(t)}emitEvent(t){this.subscribers.forEach(e=>e.handleEvent(t))}}class a extends n{constructor(t){super(),this.options=t}}class o{}class r{}s(5);class l extends a{constructor(t){super(t),this.WRAPPER_CLASS_NAME="button-wrapper",this.BUTTON_CLASS_NAME="btn btn-success",this.state=new o,this.state.disabled=!1}removeNode(){this.button.onclick=null,this.renderedNode.remove()}setDisabled(){this.state.disabled=!0,this.button.disabled=this.state.disabled}setEnabled(){this.state.disabled=!1,this.button.disabled=this.state.disabled}makeNode(){const t=document.createElement("div");t.classList.add(this.WRAPPER_CLASS_NAME);const e=document.createElement("button");return e.className=this.BUTTON_CLASS_NAME,e.innerText=this.options.buttonText,t.append(e),e.onclick=t=>{t.preventDefault();const e=new r;e.name="click",e.data=null,e.target=this,this.emitEvent(e)},this.button=e,t}}s(6);class d extends i{constructor(){super(...arguments),this.LOADER_CLASS_NAME="spinner-border",this.LOADER_WRAPPER_CLASS_NAME="loader__wrapper",this.BACKGROUND_COLOR="green"}makeNode(){const t=document.createElement("div"),e=document.createElement("div");return t.className=this.LOADER_WRAPPER_CLASS_NAME,e.className=this.LOADER_CLASS_NAME,e.style.color=this.BACKGROUND_COLOR,t.append(e),t}removeNode(){this.renderedNode.remove()}}class h extends i{constructor(t){super(),this.FORM_GROUP_BOOTSTRAP_CLASS="form-group",this.SUBMIT_BUTTON_TEXT="Отправить",this.SUBMIT_BUTTON_WRAPPER_CLASS="submit-button__wrapper",this.INVISIBLE_CLASS="form__component_invisible",this.FORM_SUBMIT_CLASS="form__submit__wrapper",this.defaults={successCallback:t=>{console.log(t)},errorCallback:t=>{console.error(t)}},this.formInputs=[],this.options=t,this.submitInput=new l({buttonText:this.options.submitButtonText||this.SUBMIT_BUTTON_TEXT}),this.pendingLoader=new d,this.submitInput.pushSubscriber(this)}handleEvent(t){"input"!=t.name||t.target==this.submitInput||this.options.allowClickIfInvalid?"click"==t.name&&t.target==this.submitInput&&this.submit():this.checkNeedEnableButton()?this.submitInput.setEnabled():this.submitInput.setDisabled()}checkNeedEnableButton(){return!(this.options.needValidate&&!this.options.allowClickIfInvalid)||this.formInputs.reduce((t,e)=>{let s=e.validate().getValidState();return!0===t&&s},!0)}setNoPending(){this.formInputs.forEach(t=>t.setEnabled()),this.pendingLoader.addClass(this.INVISIBLE_CLASS),this.submitInput.removeClass(this.INVISIBLE_CLASS)}setPending(){this.formInputs.forEach(t=>t.setDisabled()),this.pendingLoader.removeClass(this.INVISIBLE_CLASS),this.submitInput.addClass(this.INVISIBLE_CLASS)}push(t){this.formInputs.push(t),t.pushSubscriber(this),this.isRendered&&t.render(this.inputsWrapper)}pop(){if(this.formInputs.length>0){this.formInputs[this.formInputs.length-1].destroy()}}makeNode(){const t=document.createElement("form");t.autocapitalize="off",t.autocomplete="off",t.spellcheck=!1;const e=document.createElement("div");e.classList.add(this.FORM_GROUP_BOOTSTRAP_CLASS),this.formInputs.forEach(t=>t.render(e)),t.append(e);const s=document.createElement("div");return s.classList.add(this.SUBMIT_BUTTON_WRAPPER_CLASS),this.submitInput.render(s),t.append(s),this.pendingLoader.render(t),this.pendingLoader.addClass(this.FORM_SUBMIT_CLASS),this.submitInput.addClass(this.FORM_SUBMIT_CLASS),this.setNoPending(),this.inputsWrapper=e,this.renderedNode=t,this.options.allowClickIfInvalid||this.checkNeedEnableButton()||this.submitInput.setDisabled(),t}removeNode(){this.formInputs.map(t=>t.destroy()),this.submitInput.destroy(),this.renderedNode.remove()}validate(){return this.formInputs.reduce((t,e)=>{let s=e.validateAndSetClasses();return!0===t&&s},!0)}submit(){const t=this.options.successCallback||this.defaults.successCallback,e=this.options.errorCallback||this.defaults.errorCallback;(!this.options.needValidate||this.validate())&&(this.setPending(),this.options.submitCallback(this.formInputs.map(t=>t.getPayload())).then(t).catch(e).finally(()=>this.setNoPending()))}}class u{}class c{constructor(t,e){this.isValid=t,this.invalidReason=e}getValidState(){return this.isValid}getInvalidReason(){return this.invalidReason}}class p extends n{}class m{constructor(t="",e=!1,s=!1){this.input=t,this.focused=e,this.hasFirstFocus=s}}class _{constructor(t,e){this.name=t,this.data=e}}s(7);class A extends p{constructor(t){super(),this.BOOTSTRAP_INVALID_CLASS="is-invalid",this.BOOTSTRAP_VALID_CLASS="is-valid",this.BOOTSTRAP_FORM_CONTROL="form-control",this.BOOTSTRAP_INVALID_FEEDBACK="invalid-feedback",this.TEXT_INPUT_MAP_NAME="text-input",this.INVALID_FEEDBACK_MAP_NAME="invalid-feedback",this.DEFAULT_INVALID_MESSAGE="Поле не может быть пустым",this.INVALID_FEEDBACK_INVISIBLE="invalid-feedback-invisible",this.WRAPPER_CLASS_NAME="form-input__wrapper",this.importantHtmlElements=new Map,this.options=t,this.state=new m,this.isTextarea="textarea"==t.inputType}setDisabled(){this.isRendered&&(this.importantHtmlElements.get(this.TEXT_INPUT_MAP_NAME).disabled=!0)}setEnabled(){this.isRendered&&(this.importantHtmlElements.get(this.TEXT_INPUT_MAP_NAME).disabled=!1)}getPayload(){return new _(this.state.input,this.options.inputName)}getState(){return Object.assign(this.state,{})}setState(t){this.state.input=t.input,this.state.focused=t.focused,this.state.hasFirstFocus=t.hasFirstFocus,this.importantHtmlElements.get(this.TEXT_INPUT_MAP_NAME).value=this.state.input,this.validateAndSetClasses()}validateAndSetClasses(){if(this.options.needValidate){let t=this.importantHtmlElements.get(this.TEXT_INPUT_MAP_NAME),e=this.importantHtmlElements.get(this.INVALID_FEEDBACK_MAP_NAME),s=this.validate(),i=s.getValidState();return i?(t.classList.remove(this.BOOTSTRAP_INVALID_CLASS),t.classList.add(this.BOOTSTRAP_VALID_CLASS),e.classList.add(this.INVALID_FEEDBACK_INVISIBLE)):(t.classList.remove(this.BOOTSTRAP_VALID_CLASS),t.classList.add(this.BOOTSTRAP_INVALID_CLASS),e.innerText=s.getInvalidReason(),e.classList.remove(this.INVALID_FEEDBACK_INVISIBLE)),i}return!0}isSpacesMultiply(){const t=this.state.input.length-1,e=this.state.input;return e.length>1&&e[t]==e[t-1]&&" "==e[t]}makeLabel(){const t=document.createElement("label");return t.htmlFor=this.options.inputName||this.TEXT_INPUT_MAP_NAME,t.innerText=this.options.labelText||"",t}makeTextInput(){let t;return this.isTextarea?t=document.createElement("textarea"):(t=document.createElement("input"),t.type=this.options.inputType),t.className=this.BOOTSTRAP_FORM_CONTROL,t.name=this.options.inputName||this.TEXT_INPUT_MAP_NAME,t.placeholder=this.options.placeholder||"",t}makeFeedback(){const t=document.createElement("div");return t.classList.add(this.BOOTSTRAP_INVALID_FEEDBACK,this.INVALID_FEEDBACK_INVISIBLE),t}createEvent(t){let e=new r;return e.data=this.getState(),e.name=t,e.target=this,e}makeNode(){const t=document.createElement("div");this.options.inputId&&(t.id=this.options.inputId);const e=this.makeLabel(),s=this.makeTextInput(),i=this.makeFeedback();return t.append(e,s,i),t.className=this.WRAPPER_CLASS_NAME,this.importantHtmlElements.set(this.TEXT_INPUT_MAP_NAME,s),this.importantHtmlElements.set(this.INVALID_FEEDBACK_MAP_NAME,i),s.oninput=()=>{this.state.input=s.value,!this.options.allowMultipleSpaces&&this.isSpacesMultiply()&&(s.value=s.value.substring(0,s.value.length-1),this.state.input=s.value),this.validateAndSetClasses(),this.emitEvent(this.createEvent("input"))},s.onfocus=()=>{this.state.focused=!0,this.state.hasFirstFocus=!0;new r;this.emitEvent(this.createEvent("focus"))},s.onblur=()=>{this.state.focused=!1,this.state.hasFirstFocus&&this.validateAndSetClasses(),this.emitEvent(this.createEvent("blur"))},t}validate(){if(this.options.needValidate){let t=this.state.input,e=this.options.validateFunction;return e||(e=t=>t.length>0?new c(!0,""):new c(!1,this.DEFAULT_INVALID_MESSAGE)),e(t)}return new c(!0,"")}removeNode(){const t=this.importantHtmlElements.get(this.TEXT_INPUT_MAP_NAME);t.oninput=null,t.onfocus=null,t.onblur=null,this.renderedNode.remove()}}s(8);class S extends i{constructor(t){super(),this.SNACKBAR_WRAPPER_CLASS_NAME="snackbar__wrapper",this.SNACKBAR_BOOTSTRAP_CLASSNAME="alert",this.SNACKBAR_BEFORE_DESTROY_CLASS_TOP="snackbar__wrapper_before-destroy-top",this.SNACKBAR_BEFORE_DESTROY_CLASS_BOTTOM="snackbar__wrapper_before-destroy-bottom",this.BOTTOM_SNACKBAR_CLASS="snackbar__wrapper_bottom",this.defaults={color:"green",textColor:"white",bottom:!1,lifetime:1500},this.options=t}makeNode(){const t=document.createElement("div");t.className=this.SNACKBAR_WRAPPER_CLASS_NAME;const e=document.createElement("div");return e.className=this.SNACKBAR_BOOTSTRAP_CLASSNAME,e.innerText=this.options.message,e.style.backgroundColor=this.options.color||this.defaults.color,e.style.color=this.options.textColor||this.defaults.textColor,t.appendChild(e),this.options.bottom&&t.classList.add(this.BOTTOM_SNACKBAR_CLASS),setTimeout(()=>{this.removeNode()},this.options.lifetime||this.defaults.lifetime),t}async playCloseAnimation(){return new Promise((t,e)=>{let s=this.options.bottom?this.SNACKBAR_BEFORE_DESTROY_CLASS_BOTTOM:this.SNACKBAR_BEFORE_DESTROY_CLASS_TOP;this.renderedNode.classList.add(s),this.renderedNode.ontransitionend=e=>{t()}})}removeNode(){this.playCloseAnimation().finally(()=>{this.renderedNode.ontransitionend=null,this.renderedNode.remove()})}}const E=new class{};E.lifetime=2500,E.color="red",E.message="Не удалось добавить сообщение. Повторите попытку позже",E.bottom=!0;const I=new class{};I.allowClickIfInvalid=!1,I.needValidate=!0,I.submitButtonText="Оставить сообщение",I.submitCallback=async()=>new Promise((t,e)=>{setTimeout(()=>e(),1500)}),I.errorCallback=()=>{new S(E).render(document.body)};let N=new class{constructor(t){this.formInstance=new h(t)}buildNameInput(){const t=new u;t.inputType="text",t.allowMultipleSpaces=!1,t.inputName="input-name",t.labelText="Ваше имя",t.placeholder="Ваше имя (5 - 15 символов)",t.needValidate=!0,t.validateFunction=t=>{let e=t.split(" ").join("").length;return 0==e?new c(!1,"Поле не может быть пустым"):e<5?new c(!1,"Поле должно содержать более 5 символов"):e>15?new c(!1,"Поле должно содержать менее 15 символов"):/[^0-9a-zA-zА-Яа-яыё\s]/.test(t)?new c(!1,"Поле должно содержать только цифры или буквы русского или латинского алфавита"):new c(!0,"")};const e=new A(t);this.formInstance.push(e)}buildEmailInput(){const t=new u;t.allowMultipleSpaces=!1,t.inputType="email",t.inputName="input-email",t.labelText="Ваш email",t.placeholder="Email - address",t.needValidate=!0,t.validateFunction=t=>0==t.length?new c(!1,"Поле не может быть пустым"):/[^0-9a-zA-z@.]/.test(t)?new c(!1,"Поле должно содержать только буквы латинского алфавита, цифры и знак @"):t.indexOf("@")!=t.lastIndexOf("@")||t.indexOf("@")<1||t.lastIndexOf("@")>t.length-3?new c(!1,"Некорректный email"):new c(!0,"");const e=new A(t);this.formInstance.push(e)}buildUserMessage(){const t=new u;t.allowMultipleSpaces=!0,t.inputType="textarea",t.inputName="input-message",t.labelText="Ваше сообщение",t.placeholder="Ваше сообщение (150 - 1000 символов)",t.needValidate=!0,t.validateFunction=t=>{let e=t.split(" ").join("").length;return 0==e?new c(!1,"Поле не может быть пустым"):e<150?new c(!1,"Поле должно содержать более 150 символов"):e>1e3?new c(!1,"Поле должно содержать менее 1000 символов"):/[^0-9a-zA-zА-Яа-яыё\s-]/.test(t)?new c(!1,"Поле должно содержать только буквы русского или латинского алфавита, цифры и дефис"):new c(!0,"")};const e=new A(t);this.formInstance.push(e)}getInstance(){return this.formInstance}}(I);N.buildNameInput(),N.buildEmailInput(),N.buildUserMessage();e.default={instance:N.getInstance()}}]]);
//# sourceMappingURL=1.app.bundle.js.map